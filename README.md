ðŸ˜ˆ ARP Spoofing Man-in-the-Middle ToolThis is a Python network security script that performs an ARP Spoofing attack to demonstrate a Man-in-the-Middle (MITM) scenario on a local network. It utilizes the powerful Scapy library for crafting, sending, and sniffing network packets.Disclaimer: This tool is for educational purposes only. Use it responsibly and only on networks and devices where you have explicit permission. The author is not responsible for any misuse.ðŸ’» How It WorksThe script operates by actively poisoning the ARP caches of two target machines: the victim and the router (gateway).ARP Poisoning: The script continuously sends forged ARP Reply packets.It tells the victim that the attacker's MAC address is the router's IP address.It tells the router that the attacker's MAC address is the victim's IP address.Traffic Interception: Once poisoned, all network traffic intended to flow between the victim and the router is instead redirected through the attacker's machine.Data Sniffing: The script enables IP forwarding on the attacker's machine to allow traffic to pass through (preventing a denial-of-service), and simultaneously uses Scapy's sniffing function to capture and inspect the data in transit.Targeted Extraction: It is configured to specifically filter and print the raw HTTP payload (Port 80), demonstrating how unencrypted credentials or data can be exposed.âš™ï¸ Prerequisites & Installation1. RequirementsYou must have Python 3 and the Scapy library installed.Bash# Install Scapy
pip3 install scapy
2. IP ForwardingFor a true MITM attack to work (i.e., for traffic to continue flowing after interception), you must enable IP forwarding on your attacking machine:Bash# For Linux: Enable IP Forwarding
echo 1 > /proc/sys/net/ipv4/ip_forward

# To make this change permanent (optional):
# sysctl -w net.ipv4.ip_forward=1
ðŸš€ UsageThe script requires root/administrator privileges (sudo) to craft and sniff raw network packets.Command SyntaxBashsudo python3 MITMscapy.py -i <interface> -r <router_ip> -v <victim_ip>
ParametersFlagArgumentDescription-i, --interface<interface>The name of your network interface (e.g., eth0, wlan0, en0).-r, --routerIP<router_ip>The IP address of the local network gateway/router.-v, --victimIP<victim_ip>The IP address of the target machine.ExampleBashsudo python3 MITMscapy.py -i eth0 -r 192.168.1.1 -v 192.168.1.100
ðŸ§¹ Safe Exit & CleanupThe script is designed for a clean exit, which is critical for restoring network stability:It uses atexit.register(restore) to automatically call the restore() function when the script is terminated.To Stop: Press Ctrl+C in the terminal. The script will automatically send the correct ARP packets to restore the proper ARP caches on the victim and the router, ensuring normal network traffic resumes.
